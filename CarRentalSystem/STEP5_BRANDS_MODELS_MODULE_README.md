# ШАГ 5: Модуль "Марки и Модели" (Brands & Models) - README

## Обзор
Этот модуль предоставляет полную функциональность управления марками и моделями автомобилей в системе аренды автомобилей.

## Созданные компоненты

### Контроллеры

#### 1. BrandsController (`Controllers/BrandsController.cs`)
**Основные методы:**
- `Index(string searchString, string country, string bodyType)` - Список всех марок с фильтрацией
- `Details(int id)` - Детальная информация о марке со связанными моделями
- `Create()` (GET/POST) - Создание новой марки
- `Edit(int id)` (GET/POST) - Редактирование существующей марки
- `Delete(int id)` (GET/POST) - Удаление марки

**Особенности:**
- Фильтрация по названию, стране и типу кузова
- Подсчет количества моделей для каждой марки
- Проверка на наличие связанных моделей перед удалением
- Валидация уникальности названия марки

#### 2. ModelsController (`Controllers/ModelsController.cs`)
**Основные методы:**
- `Index(string searchString, int? brandId)` - Список всех моделей с фильтрацией
- `Create()` (GET/POST) - Создание новой модели
- `Edit(int id)` (GET/POST) - Редактирование существующей модели
- `Delete(int id)` (GET/POST) - Удаление модели

**Особенности:**
- Фильтрация по названию модели и марке
- Подсчет количества автомобилей для каждой модели
- Проверка на наличие связанных автомобилей перед удалением
- Валидация уникальности названия модели в рамках одной марки

### Представления (Views)

#### Brands
1. **Index.cshtml** - Карточный вид списка марок с фильтрами
2. **Details.cshtml** - Детальная информация о марке с таблицей связанных моделей
3. **Create.cshtml** - Форма создания новой марки
4. **Edit.cshtml** - Форма редактирования марки
5. **Delete.cshtml** - Подтверждение удаления марки

#### Models
1. **Index.cshtml** - Табличный вид списка моделей с фильтрами
2. **Create.cshtml** - Форма создания новой модели
3. **Edit.cshtml** - Форма редактирования модели
4. **Delete.cshtml** - Подтверждение удаления модели

## Функциональность

### Управление марками (Brands)

#### Поля марки:
- **BrandName** (обязательное) - Название марки
- **Country** (опциональное) - Страна производства
- **BodyType** (опциональное) - Тип кузова (Sedan, SUV, Hatchback и т.д.)
- **Year** (опциональное) - Год (2000-2025)
- **Transmission** (опциональное) - Тип трансмиссии (Manual, Automatic, Semi-Automatic, CVT)

#### Функции:
- ? Просмотр всех марок в виде карточек
- ? Фильтрация по названию, стране и типу кузова
- ? Создание новой марки
- ? Редактирование существующей марки
- ? Удаление марки (только если нет связанных моделей)
- ? Просмотр детальной информации с таблицей связанных моделей
- ? Подсчет количества моделей для каждой марки

### Управление моделями (Models)

#### Поля модели:
- **ModelName** (обязательное) - Название модели
- **BrandId** (обязательное) - Связь с маркой

#### Функции:
- ? Просмотр всех моделей в табличном виде
- ? Фильтрация по названию модели и марке
- ? Создание новой модели
- ? Редактирование существующей модели
- ? Удаление модели (только если нет связанных автомобилей)
- ? Просмотр количества автомобилей для каждой модели
- ? Быстрые ссылки на управление марками

## Интеграция с навигацией

Модуль интегрирован в главное меню навигации в dropdown "Vehicles":
- **All Cars** - Все автомобили
- **Brands** - Управление марками
- **Models** - Управление моделями

## Валидация и проверки

### Brands:
- Уникальность названия марки
- Проверка на наличие связанных моделей при удалении
- Валидация года (2000-2025)
- Максимальная длина полей согласно схеме базы данных

### Models:
- Уникальность названия модели в рамках одной марки
- Проверка на наличие связанных автомобилей при удалении
- Обязательная привязка к марке

## UI/UX особенности

### Brands:
- **Карточный дизайн** для лучшей визуализации
- **Цветовая индикация** для статусов
- **Hover эффекты** на карточках
- **Адаптивная сетка** (responsive grid)
- **Badges** для отображения количества моделей

### Models:
- **Табличное представление** для компактности
- **Badge-индикаторы** для марок и статусов
- **Интерактивные ссылки** на детали марок
- **Кнопки действий** с иконками Font Awesome
- **Цветовая кодировка** количества автомобилей

## Сообщения и уведомления

Система использует TempData для отображения сообщений:
- ? **Успешные операции** (зеленый цвет)
- ? **Ошибки** (красный цвет)
- ?? **Предупреждения** при попытке удаления с зависимостями

Сообщения автоматически исчезают через 5 секунд.

## Технические детали

### Используемые технологии:
- ASP.NET Core MVC (Razor Pages)
- Entity Framework Core
- Bootstrap 5
- Font Awesome Icons
- jQuery

### Зависимости:
- CarRentalContext (база данных)
- Brand и Model entities
- Car entity (для подсчета связей)

## Безопасность

- ? CSRF защита (ValidateAntiForgeryToken)
- ? Проверка существования записей
- ? Валидация на стороне сервера и клиента
- ? Обработка ошибок конкурентного доступа

## Дальнейшие улучшения

Возможные улучшения в будущих версиях:
1. Пагинация для больших списков
2. Сортировка колонок в таблицах
3. Экспорт данных в Excel/PDF
4. Загрузка изображений марок
5. История изменений
6. Массовые операции

## Тестирование

Рекомендуется протестировать:
- ? Создание марки и модели
- ? Редактирование существующих записей
- ? Фильтрацию и поиск
- ? Попытку удаления с зависимостями
- ? Успешное удаление без зависимостей
- ? Валидацию форм

## Автор и дата
Создано: Январь 2025
Версия: 1.0
